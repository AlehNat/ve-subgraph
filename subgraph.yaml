specVersion: 0.0.4
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Controller
    network: fuji
    source:
      address: "0x6eEFe56159B5fE6626541CB55744C50B5FbA59D6"
      abi: Controller
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ControllerEntity
        - AddressChangeAnnounceEntity
        - ProxyUpgradeAnnounceEntity
      abis:
        - name: Controller
          file: ./abis/ControllerV2.json
        - name: Proxy
          file: ./abis/Proxy.json
        - name: Liquidator
          file: ./abis/TetuLiquidator.json
      eventHandlers:
        - event: AddressChangeAnnounced(uint256,address)
          handler: handleAddressChangeAnnounced
        - event: AddressChanged(uint256,address,address)
          handler: handleAddressChanged
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: ProxyUpgradeAnnounced(address,address)
          handler: handleProxyUpgradeAnnounced
        - event: ProxyUpgraded(address,address)
          handler: handleProxyUpgraded
        - event: RegisterVault(address)
          handler: handleRegisterVault
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: VaultRemoved(address)
          handler: handleVaultRemoved
        - event: AddressAnnounceRemove(uint256)
          handler: handleAddressAnnounceRemove
        - event: ProxyAnnounceRemoved(address)
          handler: handleProxyAnnounceRemoved
        - event: Upgraded(indexed address)
          handler: handleUpgraded
        - event: OperatorAdded(address)
          handler: handleOperatorAdded
        - event: OperatorRemoved(address)
          handler: handleOperatorRemoved
      file: ./src/controller.ts

  - kind: ethereum/contract
    name: Forwarder
    network: fuji
    source:
      address: "0x811eb43826CB1c8f83400449f967DdC507360728"
      abi: Forwarder
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ForwarderEntity
      abis:
        - name: Forwarder
          file: ./abis/ForwarderV3.json
      eventHandlers:
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: Distributed(address,address,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleDistributed
        - event: GaugeRatioChanged(uint256,uint256)
          handler: handleGaugeRatioChanged
        - event: InvestFundRatioChanged(uint256,uint256)
          handler: handleInvestFundRatioChanged
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: SlippageChanged(address,uint256)
          handler: handleSlippageChanged
        - event: TetuThresholdChanged(uint256,uint256)
          handler: handleTetuThresholdChanged
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/forwarder.ts

  - kind: ethereum/contract
    name: PlatformVoter
    network: fuji
    source:
      address: "0x1Ae75D0A2AFE092b1aC417c5c43515E54eE12E51"
      abi: PlatformVoter
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - PlatformVoterEntity
      abis:
        - name: PlatformVoter
          file: ./abis/PlatformVoter.json
      eventHandlers:
        - event: AttributeChanged(uint256,uint256)
          handler: handleAttributeChanged
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: VoteReset(uint256,uint256,address,uint256,uint256,uint256)
          handler: handleVoteReset
        - event: Voted(uint256,uint256,uint256,address,uint256,uint256,uint256,uint256,uint256)
          handler: handleVoted
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/platfrom-voter.ts

  - kind: ethereum/contract
    name: MultiBribe
    network: fuji
    source:
      address: "0x633b054bb63a0e13012e28167A916201892d122F"
      abi: MultiBribe
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - BribeEntity
      abis:
        - name: MultiBribe
          file: ./abis/MultiBribe.json
      eventHandlers:
        - event: BalanceDecreased(indexed address,indexed address,uint256)
          handler: handleBalanceDecreased
        - event: BalanceIncreased(indexed address,indexed address,uint256)
          handler: handleBalanceIncreased
        - event: BribeDeposit(indexed address,indexed uint256,uint256)
          handler: handleBribeDeposit
        - event: BribeWithdraw(indexed address,indexed uint256,uint256)
          handler: handleBribeWithdraw
        - event: ClaimRewards(indexed address,address,indexed address,uint256,address)
          handler: handleClaimRewards
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: NotifyReward(indexed address,address,indexed address,uint256)
          handler: handleNotifyReward
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/bribe.ts

  - kind: ethereum/contract
    name: MultiGauge
    network: fuji
    source:
      address: "0x4bf56695415F725E43c3E04354b604bcFb6DFb6E"
      abi: MultiGauge
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - GaugeEntity
      abis:
        - name: MultiGauge
          file: ./abis/MultiGauge.json
      eventHandlers:
        - event: BalanceDecreased(indexed address,indexed address,uint256)
          handler: handleBalanceDecreased
        - event: BalanceIncreased(indexed address,indexed address,uint256)
          handler: handleBalanceIncreased
        - event: ClaimRewards(indexed address,address,indexed address,uint256,address)
          handler: handleClaimRewards
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: Deposit(indexed address,indexed address,uint256)
          handler: handleDeposit
        - event: NotifyReward(indexed address,address,indexed address,uint256)
          handler: handleNotifyReward
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: VeTokenLocked(indexed address,indexed address,uint256)
          handler: handleVeTokenLocked
        - event: VeTokenUnlocked(indexed address,indexed address,uint256)
          handler: handleVeTokenUnlocked
        - event: Withdraw(indexed address,indexed address,uint256,bool,uint256)
          handler: handleWithdraw
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/gauge.ts

  - kind: ethereum/contract
    name: TetuVoter
    network: fuji
    source:
      address: "0x91aB05f1da222A74CeaCCD895FEe011749ce0C1C"
      abi: TetuVoter
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - TetuVoterEntity
      abis:
        - name: TetuVoter
          file: ./abis/TetuVoter.json
      eventHandlers:
        - event: Abstained(uint256,int256)
          handler: handleAbstained
        - event: Attach(indexed address,indexed address,indexed address,uint256)
          handler: handleAttach
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Detach(indexed address,indexed address,indexed address,uint256)
          handler: handleDetach
        - event: DistributeReward(indexed address,indexed address,uint256)
          handler: handleDistributeReward
        - event: GaugeCreated(indexed address,address,indexed address,indexed address)
          handler: handleGaugeCreated
        - event: NotifyReward(indexed address,uint256)
          handler: handleNotifyReward
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: Voted(indexed address,uint256,int256)
          handler: handleVoted
        - event: Whitelisted(indexed address,indexed address)
          handler: handleWhitelisted
        - event: Withdraw(indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/tetu-voter.ts

  - kind: ethereum/contract
    name: VeDistributor
    network: fuji
    source:
      address: "0xcEd6998485B1cc3f47Bbc80f7456cdB9B02bf8e1"
      abi: VeDistributor
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - VeDistEntity
      abis:
        - name: VeDistributor
          file: ./abis/VeDistributor.json
      eventHandlers:
        - event: CheckpointToken(uint256,uint256)
          handler: handleCheckpointToken
        - event: Claimed(uint256,uint256,uint256,uint256)
          handler: handleClaimed
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/ve-dist.ts

  - kind: ethereum/contract
    name: VeTetu
    network: fuji
    source:
      address: "0xd8FB34AEb9CEbb0A72d46A078978c9918b133579"
      abi: VeTetu
      startBlock: 10993329
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - VeTetuEntity
      abis:
        - name: VeTetu
          file: ./abis/VeTetu.json
      eventHandlers:
        - event: Approval(indexed address,indexed address,indexed uint256)
          handler: handleApproval
        - event: ApprovalForAll(indexed address,indexed address,bool)
          handler: handleApprovalForAll
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: Deposit(indexed address,indexed address,uint256,uint256,indexed uint256,uint8,uint256)
          handler: handleDeposit
        - event: PawnshopWhitelisted(address)
          handler: handlePawnshopWhitelisted
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: Supply(indexed address,uint256,uint256)
          handler: handleSupply
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
        - event: Withdraw(indexed address,indexed address,uint256,uint256,uint256)
          handler: handleWithdraw
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/ve.ts
  - kind: ethereum/contract
    name: VaultFactory
    network: fuji
    source:
      address: "0xD35951C225A5B691462ff82B549e94AAF7dD1fbd"
      abi: VaultFactory
      startBlock: 10907395
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - VaultFactoryEntity
      abis:
        - name: VaultFactory
          file: ./abis/VaultFactory.json
        - name: Vault
          file: ./abis/TetuVaultV2.json
        - name: Controller
          file: ./abis/ControllerV2.json
        - name: Proxy
          file: ./abis/Proxy.json
        - name: Liquidator
          file: ./abis/TetuLiquidator.json
        - name: StrategySplitter
          file: ./abis/StrategySplitterV2.json
      eventHandlers:
        - event: VaultDeployed(address,address,string,string,address,uint256,address,address,address,address,address)
          handler: handleVaultDeployed
        - event: VaultImplChanged(address)
          handler: handleVaultImplChanged
        - event: VaultInsuranceImplChanged(address)
          handler: handleVaultInsuranceImplChanged
        - event: SplitterImplChanged(address)
          handler: handleSplitterImplChanged
      file: ./src/vault-factory.ts

templates:
  - name: Vault
    kind: ethereum/contract
    network: fuji
    source:
      abi: Vault
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/vault.ts
      entities:
        - VaultEntity
        - InsuranceEntity
        - VaultApproveEntity
        - UserVault
      abis:
        - name: Vault
          file: ./abis/TetuVaultV2.json
        - name: Insurance
          file: ./abis/VaultInsurance.json
        - name: Controller
          file: ./abis/ControllerV2.json
        - name: Liquidator
          file: ./abis/TetuLiquidator.json
      eventHandlers:
        - event: Approval(indexed address,indexed address,uint256)
          handler: handleApproval
        - event: Upgraded(indexed address)
          handler: handleUpgraded
        - event: BufferChanged(uint256,uint256)
          handler: handleBufferChanged
        - event: DoHardWorkOnInvestChanged(bool,bool)
          handler: handleDoHardWorkOnInvestChanged
        - event: FeeChanged(uint256,uint256)
          handler: handleFeeChanged
        - event: FeeTransfer(uint256)
          handler: handleFeeTransfer
        - event: LossCovered(uint256)
          handler: handleLossCovered
        - event: MaxDepositChanged(uint256,uint256)
          handler: handleMaxDepositChanged
        - event: MaxWithdrawChanged(uint256,uint256)
          handler: handleMaxWithdrawChanged
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: SplitterChanged(address,address)
          handler: handleSplitterChanged
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer

  - name: StrategySplitter
    kind: ethereum/contract
    network: fuji
    source:
      abi: StrategySplitter
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/splitter.ts
      entities:
        - SplitterEntity
      abis:
        - name: StrategySplitter
          file: ./abis/StrategySplitterV2.json
        - name: Vault
          file: ./abis/TetuVaultV2.json
        - name: Controller
          file: ./abis/ControllerV2.json
        - name: Liquidator
          file: ./abis/TetuLiquidator.json
        - name: Strategy
          file: ./abis/StrategyBaseV2.json
        - name: Proxy
          file: ./abis/Proxy.json
      eventHandlers:
        - event: ContinueInvesting(address,uint256,address)
          handler: handleContinueInvesting
        - event: Upgraded(indexed address)
          handler: handleUpgraded
        - event: HardWork(address,address,uint256,uint256,uint256,uint256,uint256)
          handler: handleHardWork
        - event: ManualAprChanged(address,address,uint256,uint256)
          handler: handleManualAprChanged
        - event: Paused(address,address)
          handler: handlePaused
        - event: Rebalance(address,address,uint256,uint256,uint256,uint256)
          handler: handleRebalance
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: StrategyAdded(address,uint256)
          handler: handleStrategyAdded
        - event: StrategyRatioChanged(address,uint256)
          handler: handleStrategyRatioChanged
        - event: StrategyRemoved(address)
          handler: handleStrategyRemoved
        - event: StrategyScheduled(address,uint256,uint256)
          handler: handleStrategyScheduled
        - event: ScheduledStrategyRemove(address)
          handler: handleScheduledStrategyRemove
        - event: Loss(address,uint256)
          handler: handleLoss
        - event: Invested(address,uint256)
          handler: handleInvested
        - event: WithdrawFromStrategy(address)
          handler: handleWithdrawFromStrategy

  - name: Strategy
    kind: ethereum/contract
    network: fuji
    source:
      abi: Strategy
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/strategy.ts
      entities:
        - StrategyEntity
      abis:
        - name: Strategy
          file: ./abis/StrategyBaseV2.json
      eventHandlers:
        - event: Claimed(address,uint256)
          handler: handleClaimed
        - event: Upgraded(indexed address)
          handler: handleUpgraded
        - event: CompoundRatioChanged(uint256,uint256)
          handler: handleCompoundRatioChanged
        - event: ContractInitialized(address,uint256,uint256)
          handler: handleContractInitialized
        - event: DepositToPool(uint256)
          handler: handleDepositToPool
        - event: EmergencyExit(address,uint256)
          handler: handleEmergencyExit
        - event: InvestAll(uint256)
          handler: handleInvestAll
        - event: ManualClaim(address)
          handler: handleManualClaim
        - event: RevisionIncreased(uint256,address)
          handler: handleRevisionIncreased
        - event: WithdrawAllFromPool(uint256)
          handler: handleWithdrawAllFromPool
        - event: WithdrawAllToSplitter(uint256)
          handler: handleWithdrawAllToSplitter
        - event: WithdrawFromPool(uint256)
          handler: handleWithdrawFromPool
        - event: WithdrawToSplitter(uint256,uint256,uint256)
          handler: handleWithdrawToSplitter



